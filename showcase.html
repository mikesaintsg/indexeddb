<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IndexedDB Showcase</title>
  <script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();class v extends Error{code;cause;constructor(t,e,n){super(e),this.name="DatabaseError",this.code=t,this.cause=n,Object.setPrototypeOf(this,new.target.prototype)}}class q extends v{storeName;key;constructor(t,e){const n=Y(e);super("NOT_FOUND",`Record not found in "${t}" with key: ${n}`),this.name="NotFoundError",this.storeName=t,this.key=e}}class ut extends v{storeName;key;constructor(t,e,n){const s=Y(e);super("CONSTRAINT_ERROR",`Key already exists in "${t}": ${s}`,n),this.name="ConstraintError",this.storeName=t,this.key=e}}class ht extends v{constructor(t){super("QUOTA_EXCEEDED","Storage quota exceeded",t),this.name="QuotaExceededError"}}class D extends v{constructor(t,e,n){super(t,e,n),this.name="TransactionError"}}class Q extends v{constructor(t,e,n){super(t,e,n),this.name="UpgradeError"}}class mt extends v{constructor(t,e){super("OPEN_FAILED",t,e),this.name="OpenError"}}class pt extends v{constructor(t,e){super("DATA_ERROR",t,e),this.name="DataError"}}class ft extends v{constructor(t,e){super("READ_ONLY",t,e),this.name="ReadOnlyError"}}class yt extends v{constructor(t,e){super("VERSION_ERROR",t,e),this.name="VersionError"}}class V extends v{constructor(t,e){super("INVALID_STATE",t,e),this.name="InvalidStateError"}}class wt extends v{constructor(t,e){super("TIMEOUT",t,e),this.name="TimeoutError"}}function g(r,t){if(!r)return new v("UNKNOWN_ERROR","Unknown error occurred");const e=t?.storeName??"",n=t?.key??"";switch(r.name){case"ConstraintError":return new ut(e,n,r);case"QuotaExceededError":return new ht(r);case"TransactionInactiveError":return new D("TRANSACTION_INACTIVE",r.message||"Transaction is not active",r);case"AbortError":return new D("TRANSACTION_ABORTED",r.message||"Transaction was aborted",r);case"VersionError":return new yt(r.message||"Version error",r);case"DataError":return new pt(r.message||"Data error",r);case"InvalidStateError":return new V(r.message||"Invalid state",r);case"ReadOnlyError":return new ft(r.message||"Attempted write in read-only transaction",r);case"NotFoundError":return new v("NOT_FOUND",r.message||"Object store or index not found",r);case"TimeoutError":return new wt(r.message||"Operation timed out",r);default:return new v("UNKNOWN_ERROR",r.message||`Unknown error: ${r.name}`,r)}}function Y(r){return typeof r=="string"?`"${r}"`:typeof r=="number"?String(r):r instanceof Date?r.toISOString():Array.isArray(r)?`[${r.map(Y).join(", ")}]`:r instanceof ArrayBuffer||ArrayBuffer.isView(r)?"[Binary Data]":String(r)}const nt="id",st=!1,K={DATABASE_NOT_OPEN:"Database connection is not open",DATABASE_CLOSED:"Database connection has been closed",STORE_NOT_FOUND:r=>`Object store "${r}" not found`,INDEX_NOT_FOUND:r=>`Index "${r}" not found`,TRANSACTION_INACTIVE:"Transaction is no longer active",TRANSACTION_MODE_MISMATCH:"Operation requires readwrite transaction",INVALID_KEY:"Invalid key type for this operation",NATIVE_ACCESS_NO_TRANSACTION:"Native store access requires active transaction",UPGRADE_BLOCKED:"Database upgrade blocked by other connections",UPGRADE_FAILED:"Database upgrade failed",OPEN_FAILED:"Failed to open database"};function Z(r){return new Promise((t,e)=>{r.oncomplete=()=>t(),r.onerror=()=>{e(g(r.error))},r.onabort=()=>{e(new D("TRANSACTION_ABORTED",r.error?.message??"Transaction was aborted",r.error))}})}function rt(r){if(r==null)return!1;const t=typeof r;return t==="number"?!Number.isNaN(r):t==="string"?!0:r instanceof Date?!Number.isNaN(r.getTime()):r instanceof ArrayBuffer||ArrayBuffer.isView(r)?!0:Array.isArray(r)?r.every(rt):!1}function tt(r){return Array.isArray(r)?r:[r]}function gt(r){return typeof r=="number"&&Number.isInteger(r)&&r>0}function bt(r){if(!gt(r))throw new Error(`Database version must be a positive integer, got: ${String(r)}`)}function xt(r){if(r.length===0)throw new Error("Database name must be a non-empty string")}function N(r){return r===void 0?"next":r==="previous"?"prev":r==="previousunique"?"prevunique":r}function ot(r){return r==="prev"?"previous":r==="prevunique"?"previousunique":r}class O{#e;#t;constructor(t,e){this.#e=t,this.#t=e}get native(){return this.#e}getKey(){return this.#e.key}getPrimaryKey(){return this.#e.primaryKey}getValue(){return this.#e.value}getDirection(){return ot(this.#e.direction)}async continue(t){return new Promise((e,n)=>{this.#t.onsuccess=()=>{const s=this.#t.result;e(s?new O(s,this.#t):null)},this.#t.onerror=()=>n(g(this.#t.error)),t!==void 0?this.#e.continue(t):this.#e.continue()})}async continuePrimaryKey(t,e){return new Promise((n,s)=>{this.#t.onsuccess=()=>{const o=this.#t.result;n(o?new O(o,this.#t):null)},this.#t.onerror=()=>s(g(this.#t.error)),this.#e.continuePrimaryKey(t,e)})}async advance(t){return new Promise((e,n)=>{this.#t.onsuccess=()=>{const s=this.#t.result;e(s?new O(s,this.#t):null)},this.#t.onerror=()=>n(g(this.#t.error)),this.#e.advance(t)})}async update(t){return new Promise((e,n)=>{const s=this.#e.update(t);s.onsuccess=()=>e(s.result),s.onerror=()=>n(g(s.error))})}async delete(){return new Promise((t,e)=>{const n=this.#e.delete();n.onsuccess=()=>t(),n.onerror=()=>e(g(n.error))})}}class I{#e;#t;constructor(t,e){this.#e=t,this.#t=e}get native(){return this.#e}getKey(){return this.#e.key}getPrimaryKey(){return this.#e.primaryKey}getDirection(){return ot(this.#e.direction)}async continue(t){return new Promise((e,n)=>{this.#t.onsuccess=()=>{const s=this.#t.result;e(s?new I(s,this.#t):null)},this.#t.onerror=()=>n(g(this.#t.error)),t!==void 0?this.#e.continue(t):this.#e.continue()})}async continuePrimaryKey(t,e){return new Promise((n,s)=>{this.#t.onsuccess=()=>{const o=this.#t.result;n(o?new I(o,this.#t):null)},this.#t.onerror=()=>s(g(this.#t.error)),this.#e.continuePrimaryKey(t,e)})}async advance(t){return new Promise((e,n)=>{this.#t.onsuccess=()=>{const s=this.#t.result;e(s?new I(s,this.#t):null)},this.#t.onerror=()=>n(g(this.#t.error)),this.#e.advance(t)})}}function vt(){return{keyPath:null,range:null,anyOfValues:null,filters:[],direction:"ascending",limitCount:null,offsetCount:0}}class w{#e;#t;constructor(t,e){this.#e=t,this.#t=e??vt()}where(t){return new Ct(this.#e,{...this.#t,keyPath:t})}filter(t){return new w(this.#e,{...this.#t,filters:[...this.#t.filters,t]})}orderBy(t){return new w(this.#e,{...this.#t,direction:t})}limit(t){return new w(this.#e,{...this.#t,limitCount:t})}offset(t){return new w(this.#e,{...this.#t,offsetCount:t})}async toArray(){const t=[];for await(const e of this.iterate())t.push(e);return t}async first(){const e=await new w(this.#e,{...this.#t,limitCount:1}).iterate().next();return e.done?void 0:e.value}async count(){if(this.#t.filters.length===0&&this.#t.anyOfValues===null){const s=(await this.#e.ensureOpen()).transaction([this.#e.storeName],"readonly").objectStore(this.#e.storeName),i=this.#n(s).count(this.#t.range??void 0);return this.#i(i)}let t=0;for await(const e of this.iterate())t++;return t}async keys(){const t=[],s=(await this.#e.ensureOpen()).transaction([this.#e.storeName],"readonly").objectStore(this.#e.storeName),o=this.#n(s),i=N(this.#t.direction==="ascending"?"next":"previous");if(this.#t.anyOfValues!==null){const m=await this.#a(s);return this.#l(m)}const c=o.openKeyCursor(this.#t.range??void 0,i);let l=0,d=0,u=await this.#i(c);for(;u;){if(l<this.#t.offsetCount){l++,u.continue(),u=await this.#i(c);continue}if(this.#t.limitCount!==null&&d>=this.#t.limitCount)break;if(this.#t.filters.length>0){const m=s.get(u.primaryKey),h=await this.#i(m);h!==void 0&&this.#r(h)&&(t.push(u.primaryKey),d++)}else t.push(u.primaryKey),d++;u.continue(),u=await this.#i(c)}return t}async*iterate(){const n=(await this.#e.ensureOpen()).transaction([this.#e.storeName],"readonly").objectStore(this.#e.storeName);if(this.#t.anyOfValues!==null){const u=await this.#s(n),m=this.#l(u);for(const h of m)yield h;return}const s=this.#n(n),o=N(this.#t.direction==="ascending"?"next":"previous"),i=s.openCursor(this.#t.range??void 0,o);let c=0,l=0,d=await this.#i(i);for(;d;){const u=d.value;if(!this.#r(u)){d.continue(),d=await this.#i(i);continue}if(c<this.#t.offsetCount){c++,d.continue(),d=await this.#i(i);continue}if(this.#t.limitCount!==null&&l>=this.#t.limitCount)break;yield u,l++,d.continue(),d=await this.#i(i)}}#n(t){const e=this.#t.keyPath;if(e===null||e===this.#e.primaryKeyPath)return t;if(this.#e.indexNames.includes(e))return t.index(e);for(const n of this.#e.indexNames)try{const s=t.index(n);if(s.keyPath===e)return s}catch{}return t}#r(t){for(const e of this.#t.filters)if(!e(t))return!1;return!0}async#s(t){if(this.#t.anyOfValues===null)return[];const e=this.#t.keyPath,n=new Map,s=this.#t.anyOfValues.map(async i=>{let c=[];if(e===null||e===this.#e.primaryKeyPath){const l=await this.#i(t.get(i));c=l?[l]:[]}else if(this.#e.indexNames.includes(e)){const l=t.index(e);c=await this.#i(l.getAll(i))}else for(const l of this.#e.indexNames)try{const d=t.index(l);if(d.keyPath===e){c=await this.#i(d.getAll(i));break}}catch{}for(const l of c)if(this.#r(l)){const d=this.#o(l);d!==void 0&&n.set(this.#c(d),l)}});await Promise.all(s);const o=Array.from(n.values());return this.#t.direction==="descending"&&o.reverse(),o}async#a(t){if(this.#t.anyOfValues===null)return[];const e=this.#t.keyPath,n=new Set,s=[],o=this.#t.anyOfValues.map(async i=>{let c;if(e===null||e===this.#e.primaryKeyPath)c=await this.#i(t.count(i))>0?[i]:[];else if(this.#e.indexNames.includes(e)){const l=t.index(e);c=await this.#i(l.getAllKeys(i))}else c=[];for(const l of c){const d=this.#c(l);n.has(d)||(n.add(d),s.push(l))}});return await Promise.all(o),this.#t.direction==="descending"&&s.reverse(),s}#o(t){const e=this.#e.primaryKeyPath;if(!(e===null||typeof t!="object"||t===null))return t[e]}#l(t){let e=t;return this.#t.offsetCount>0&&(e=e.slice(this.#t.offsetCount)),this.#t.limitCount!==null&&(e=e.slice(0,this.#t.limitCount)),e}#i(t){return new Promise((e,n)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>n(g(t.error,{storeName:this.#e.storeName}))})}#c(t){return typeof t=="string"?t:typeof t=="number"?`n:${t}`:t instanceof Date?`d:${t.getTime()}`:t instanceof ArrayBuffer?`b:${Array.from(new Uint8Array(t)).join(",")}`:ArrayBuffer.isView(t)?`b:${Array.from(new Uint8Array(t.buffer)).join(",")}`:Array.isArray(t)?`a:${JSON.stringify(t)}`:JSON.stringify(t)}}class Ct{#e;#t;constructor(t,e){this.#e=t,this.#t=e}equals(t){return rt(t)?new w(this.#e,{...this.#t,range:IDBKeyRange.only(t)}):this.#n(t,e=>e===t)}#n(t,e){const n=this.#t.keyPath,s=o=>{if(n===null||typeof o!="object"||o===null)return!1;const i=o[n];return e(i)};return new w(this.#e,{...this.#t,keyPath:null,filters:[...this.#t.filters,s]})}greaterThan(t){return new w(this.#e,{...this.#t,range:IDBKeyRange.lowerBound(t,!0)})}greaterThanOrEqual(t){return new w(this.#e,{...this.#t,range:IDBKeyRange.lowerBound(t,!1)})}lessThan(t){return new w(this.#e,{...this.#t,range:IDBKeyRange.upperBound(t,!0)})}lessThanOrEqual(t){return new w(this.#e,{...this.#t,range:IDBKeyRange.upperBound(t,!1)})}between(t,e,n){return new w(this.#e,{...this.#t,range:IDBKeyRange.bound(t,e,n?.lowerOpen??!1,n?.upperOpen??!1)})}startsWith(t){return new w(this.#e,{...this.#t,range:IDBKeyRange.bound(t,t+"Ôøø",!1,!1)})}anyOf(t){return new w(this.#e,{...this.#t,anyOfValues:t})}}class it{#e;#t;#n;#r;constructor(t,e,n,s){this.#e=t,this.#t=e,this.#n=n,this.#r=s}get native(){throw new Error("Index.native requires active transaction. Use openCursor() or iterate().")}getName(){return this.#t}getKeyPath(){return this.#n.keyPath}isUnique(){return this.#n.unique??!1}isMultiEntry(){return this.#n.multiEntry??!1}async get(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t);return Array.isArray(t)?await Promise.all(t.map(i=>this.#s(o.get(i)))):this.#s(o.get(t))}async resolve(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t);if(Array.isArray(t))return await Promise.all(t.map(async c=>{const l=await this.#s(o.get(c));if(l===void 0)throw new q(this.#e,c);return l}));const i=await this.#s(o.get(t));if(i===void 0)throw new q(this.#e,t);return i}async getKey(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t);return this.#s(o.getKey(t))}async all(t,e){const i=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t);return this.#s(i.getAll(t??void 0,e))}async keys(t,e){const i=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t);return this.#s(i.getAllKeys(t??void 0,e))}async count(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t);return this.#s(o.count(t))}query(){return new w({storeName:this.#e,primaryKeyPath:null,indexNames:[this.#t],ensureOpen:this.#r})}async*iterate(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t),i=N(t?.direction),c=o.openCursor(t?.query??null,i);let l=await this.#s(c);for(;l;){yield l.value;const d=new Promise(u=>{c.onsuccess=()=>u(c.result)});l.continue(),l=await d}}async*iterateKeys(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t),i=N(t?.direction),c=o.openKeyCursor(t?.query??null,i);let l=await this.#s(c);for(;l;){yield l.key;const d=new Promise(u=>{c.onsuccess=()=>u(c.result)});l.continue(),l=await d}}async openCursor(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t),i=N(t?.direction),c=o.openCursor(t?.query??null,i),l=await this.#s(c);return l?new O(l,c):null}async openKeyCursor(t){const o=(await this.#r()).transaction([this.#e],"readonly").objectStore(this.#e).index(this.#t),i=N(t?.direction),c=o.openKeyCursor(t?.query??null,i),l=await this.#s(c);return l?new I(l,c):null}#s(t){return new Promise((e,n)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>n(g(t.error,{storeName:this.#e}))})}}class Nt{#e;#t;#n;#r=new Set;constructor(t,e,n){this.#e=t,this.#t=e,this.#n=n}get native(){throw new Error(K.NATIVE_ACCESS_NO_TRANSACTION)}getName(){return this.#t}getKeyPath(){return this.#n.keyPath===void 0?nt:this.#n.keyPath}getIndexNames(){return(this.#n.indexes??[]).map(t=>t.name)}hasAutoIncrement(){return this.#n.autoIncrement??st}async get(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t);return Array.isArray(t)?await Promise.all(t.map(o=>this.#s(s.get(o)))):this.#s(s.get(t))}async resolve(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t);if(Array.isArray(t))return await Promise.all(t.map(async i=>{const c=await this.#s(s.get(i));if(c===void 0)throw new q(this.#t,i);return c}));const o=await this.#s(s.get(t));if(o===void 0)throw new q(this.#t,t);return o}async has(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t);return Array.isArray(t)?await Promise.all(t.map(async i=>await this.#s(s.count(i))>0)):await this.#s(s.count(t))>0}async set(t,e){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readwrite"),o=s.objectStore(this.#t);if(Array.isArray(t)){const c=await Promise.all(t.map(l=>this.#s(o.put(l))));return await this.#a(s),this.#o("set",c),c}const i=await this.#s(o.put(t,e));return await this.#a(s),this.#o("set",[i]),i}async add(t,e){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readwrite"),o=s.objectStore(this.#t);if(Array.isArray(t)){const c=await Promise.all(t.map(l=>this.#s(o.add(l))));return await this.#a(s),this.#o("add",c),c}const i=await this.#s(o.add(t,e));return await this.#a(s),this.#o("add",[i]),i}async remove(t){const n=(await this.#e.ensureOpen()).transaction([this.#t],"readwrite"),s=n.objectStore(this.#t);if(Array.isArray(t)){await Promise.all(t.map(o=>this.#s(s.delete(o)))),await this.#a(n),this.#o("remove",t.map(o=>o));return}await this.#s(s.delete(t)),await this.#a(n),this.#o("remove",[t])}async all(t,e){const o=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t);return this.#s(o.getAll(t??void 0,e))}async keys(t,e){const o=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t);return this.#s(o.getAllKeys(t??void 0,e))}async clear(){const e=(await this.#e.ensureOpen()).transaction([this.#t],"readwrite"),n=e.objectStore(this.#t);await this.#s(n.clear()),await this.#a(e),this.#o("clear",[])}async count(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t);return this.#s(s.count(t))}index(t){const n=(this.#n.indexes??[]).find(s=>s.name===t);if(!n)throw new Error(`Index "${t}" not found on store "${this.#t}"`);return new it(this.#t,t,n,()=>this.#e.ensureOpen())}query(){const t=this.getKeyPath();return new w({storeName:this.#t,primaryKeyPath:typeof t=="string"?t:null,indexNames:this.getIndexNames(),ensureOpen:()=>this.#e.ensureOpen()})}async*iterate(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t),o=N(t?.direction),i=s.openCursor(t?.query??null,o);let c=await this.#s(i);for(;c;){yield c.value;const l=new Promise(d=>{i.onsuccess=()=>d(i.result)});c.continue(),c=await l}}async*iterateKeys(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t),o=N(t?.direction),i=s.openKeyCursor(t?.query??null,o);let c=await this.#s(i);for(;c;){yield c.key;const l=new Promise(d=>{i.onsuccess=()=>d(i.result)});c.continue(),c=await l}}async openCursor(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t),o=N(t?.direction),i=s.openCursor(t?.query??null,o),c=await this.#s(i);return c?new O(c,i):null}async openKeyCursor(t){const s=(await this.#e.ensureOpen()).transaction([this.#t],"readonly").objectStore(this.#t),o=N(t?.direction),i=s.openKeyCursor(t?.query??null,o),c=await this.#s(i);return c?new I(c,i):null}onChange(t){return this.#r.add(t),()=>this.#r.delete(t)}#s(t){return new Promise((e,n)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>n(g(t.error,{storeName:this.#t}))})}#a(t){return new Promise((e,n)=>{t.oncomplete=()=>e(),t.onerror=()=>n(g(t.error)),t.onabort=()=>n(g(t.error))})}#o(t,e){const n={storeName:this.#t,type:t,keys:e,source:"local"};for(const s of this.#r)try{s(n)}catch{}this.#e.emitChange(n)}emitRemoteChange(t){for(const e of this.#r)try{e(t)}catch{}}}class At{#e;#t;constructor(t,e){this.#e=t,this.#t=e}get native(){return this.#e}async get(t){return Array.isArray(t)?Promise.all(t.map(e=>this.#n(this.#e.get(e)))):this.#n(this.#e.get(t))}async resolve(t){if(Array.isArray(t))return Promise.all(t.map(async n=>{const s=await this.#n(this.#e.get(n));if(s===void 0)throw new q(this.#t,n);return s}));const e=await this.#n(this.#e.get(t));if(e===void 0)throw new q(this.#t,t);return e}async set(t,e){return Array.isArray(t)?Promise.all(t.map(n=>this.#n(this.#e.put(n)))):this.#n(this.#e.put(t,e))}async add(t,e){return Array.isArray(t)?Promise.all(t.map(n=>this.#n(this.#e.add(n)))):this.#n(this.#e.add(t,e))}async remove(t){if(Array.isArray(t)){await Promise.all(t.map(e=>this.#n(this.#e.delete(e))));return}await this.#n(this.#e.delete(t))}async all(t,e){return this.#n(this.#e.getAll(t??void 0,e))}async keys(t,e){return this.#n(this.#e.getAllKeys(t??void 0,e))}async clear(){await this.#n(this.#e.clear())}async count(t){return this.#n(this.#e.count(t))}index(t){if(!this.#e.indexNames.contains(t))throw new Error(`Index "${t}" not found on store "${this.#t}"`);const e=this.#e.index(t),n={name:e.name,keyPath:e.keyPath,unique:e.unique,multiEntry:e.multiEntry},s=this.#e.transaction.db;return new it(this.#t,t,n,()=>Promise.resolve(s))}async openCursor(t){const e=N(t?.direction),n=this.#e.openCursor(t?.query??null,e),s=await this.#n(n);return s?new O(s,n):null}async openKeyCursor(t){const e=N(t?.direction),n=this.#e.openKeyCursor(t?.query??null,e),s=await this.#n(n);return s?new I(s,n):null}#n(t){return new Promise((e,n)=>{t.onsuccess=()=>e(t.result),t.onerror=()=>n(g(t.error,{storeName:this.#t}))})}}class et{#e;#t;#n=!0;#r=!1;constructor(t){this.#e=t,this.#t=Array.from(t.objectStoreNames),t.oncomplete=()=>{this.#n=!1,this.#r=!0},t.onabort=()=>{this.#n=!1,this.#r=!0},t.onerror=()=>{this.#n=!1,this.#r=!0}}get native(){return this.#e}getMode(){return this.#e.mode}getStoreNames(){return this.#t}isActive(){return this.#n}isFinished(){return this.#r}store(t){if(!this.#t.includes(t))throw new D("INVALID_STATE",`Store "${t}" is not in transaction scope. Scoped stores: ${this.#t.join(", ")}`);if(!this.#n)throw new D("TRANSACTION_INACTIVE","Transaction is no longer active");const e=this.#e.objectStore(t);return new At(e,t)}abort(){if(this.#r)throw new D("INVALID_STATE","Cannot abort: transaction already finished");this.#e.abort(),this.#n=!1,this.#r=!0}commit(){if(this.#r)throw new D("INVALID_STATE","Cannot commit: transaction already finished");typeof this.#e.commit=="function"&&this.#e.commit()}}class Et{#e;#t;#n;#r;#s;#a;#o=null;#l=null;#i=!1;#c=null;#d=new Set;#h=new Set;#m=new Set;#u=new Set;#p=new Map;constructor(t){xt(t.name),bt(t.version),this.#e=t.name,this.#t=t.version,this.#n=t.stores,this.#r=t.migrations??[],this.#s=t.onBlocked,this.#a=t.crossTabSync!==!1,this.#a&&typeof BroadcastChannel<"u"&&(this.#c=new BroadcastChannel(`idb:${t.name}`),this.#c.onmessage=e=>{this.#y(e.data)}),this.#e=t.name,this.#t=t.version,this.#n=t.stores,this.#r=t.migrations??[],this.#s=t.onBlocked,t.onChange&&this.#d.add(t.onChange),t.onError&&this.#h.add(t.onError),t.onVersionChange&&this.#m.add(t.onVersionChange),t.onClose&&this.#u.add(t.onClose)}get native(){if(!this.#o)throw new V(K.DATABASE_NOT_OPEN);return this.#o}getName(){return this.#e}getVersion(){return this.#t}getStoreNames(){return this.#o?Array.from(this.#o.objectStoreNames):Object.keys(this.#n)}isOpen(){return this.#o!==null&&!this.#i}store(t){if(!(t in this.#n))throw new V(K.STORE_NOT_FOUND(t));let e=this.#p.get(t);return e||(e=new Nt(this,t,this.#n[t]),this.#p.set(t,e)),e}async read(t,e){const n=await this.ensureOpen(),s=tt(t),o=n.transaction([...s],"readonly"),i=new et(o);try{await e(i),await Z(o)}catch(c){if(i.isActive())try{i.abort()}catch{}throw c}}async write(t,e,n){const s=await this.ensureOpen(),o=tt(t),i=n?.durability?{durability:n.durability}:void 0,c=[...o],l=i?s.transaction(c,"readwrite",i):s.transaction(c,"readwrite"),d=new et(l);try{await e(d),await Z(l)}catch(u){if(d.isActive())try{d.abort()}catch{}throw u}}close(){this.#c&&(this.#c.close(),this.#c=null),this.#o&&(this.#o.close(),this.#o=null),this.#i=!0,this.#l=null;for(const t of this.#u)try{t()}catch{}}async drop(){return this.close(),new Promise((t,e)=>{const n=indexedDB.deleteDatabase(this.#e);n.onsuccess=()=>t(),n.onerror=()=>e(g(n.error)),n.onblocked=()=>{}})}onChange(t){return this.#d.add(t),()=>this.#d.delete(t)}onError(t){return this.#h.add(t),()=>this.#h.delete(t)}onVersionChange(t){return this.#m.add(t),()=>this.#m.delete(t)}onClose(t){return this.#u.add(t),()=>this.#u.delete(t)}async ensureOpen(){if(this.#i)throw new V(K.DATABASE_CLOSED);if(this.#o)return this.#o;if(this.#l)return this.#l;this.#l=this.#w();try{return this.#o=await this.#l,this.#o}catch(t){throw this.#l=null,t}}emitChange(t){for(const e of this.#d)try{e(t)}catch(n){this.#f(n instanceof Error?n:new Error(String(n)))}if(t.source==="local"&&this.#c)try{this.#c.postMessage(t)}catch{}}#y(t){const e={...t,source:"remote"};for(const s of this.#d)try{s(e)}catch(o){this.#f(o instanceof Error?o:new Error(String(o)))}const n=this.#p.get(t.storeName);n&&n.emitRemoteChange(e)}async#w(){return new Promise((t,e)=>{const n=indexedDB.open(this.#e,this.#t);n.onerror=()=>{e(new mt(`Failed to open database "${this.#e}"`,n.error))},n.onsuccess=()=>{const s=n.result;this.#g(s),t(s)},n.onupgradeneeded=s=>{const o=n.result,i=n.transaction;if(!i){e(new Q("UPGRADE_FAILED","No transaction available during upgrade"));return}try{this.#b(o,i,s.oldVersion,s.newVersion??this.#t)}catch(c){i.abort(),e(c instanceof Q?c:new Q("UPGRADE_FAILED",c instanceof Error?c.message:"Upgrade failed",c))}},n.onblocked=s=>{this.#s&&this.#s({oldVersion:s.oldVersion,newVersion:s.newVersion??this.#t})}})}#g(t){t.onversionchange=e=>{for(const n of this.#m)try{n({oldVersion:e.oldVersion,newVersion:e.newVersion})}catch{}},t.onclose=()=>{this.#o=null,this.#i=!0;for(const e of this.#u)try{e()}catch{}},t.onerror=e=>{const s=e.target?.error??new Error("Unknown database error");this.#f(s instanceof Error?s:new Error(String(s)))}}#b(t,e,n,s){for(const[i,c]of Object.entries(this.#n))t.objectStoreNames.contains(i)||this.#x(t,i,c);const o=this.#r.filter(i=>i.version>n&&i.version<=s).sort((i,c)=>i.version-c.version);for(const i of o)i.migrate({database:t,transaction:e,oldVersion:n,newVersion:s})}#x(t,e,n){const s=n.keyPath===void 0?nt:n.keyPath,i={autoIncrement:n.autoIncrement??st};s!==null&&(i.keyPath=s);const c=t.createObjectStore(e,i);for(const l of n.indexes??[])this.#v(c,l)}#v(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique??!1,multiEntry:e.multiEntry??!1})}#f(t){for(const e of this.#h)try{e(t)}catch{}}}function St(r){return new Et(r)}const Tt=[{id:"t1",title:"Learn IndexedDB basics",completed:!0,priority:"high",createdAt:Date.now()-864e5*3},{id:"t2",title:"Build a todo app",completed:!0,priority:"high",createdAt:Date.now()-864e5*2},{id:"t3",title:"Implement cross-tab sync",completed:!1,priority:"medium",createdAt:Date.now()-864e5},{id:"t4",title:"Write documentation",completed:!1,priority:"medium",createdAt:Date.now()-36e5},{id:"t5",title:"Add more examples",completed:!1,priority:"low",createdAt:Date.now()}],Pt=[{id:"n1",title:"Meeting Notes",content:"Discuss Q4 goals and roadmap",color:"#fff3cd",updatedAt:Date.now()-864e5},{id:"n2",title:"Shopping List",content:"Milk, Bread, Eggs, Coffee",color:"#d1ecf1",updatedAt:Date.now()-36e5},{id:"n3",title:"Ideas",content:"New project concepts for 2026",color:"#d4edda",updatedAt:Date.now()-18e5},{id:"n4",title:"Reminders",content:"Call dentist, Pay bills",color:"#f8d7da",updatedAt:Date.now()}],f=St({name:"showcase-app",version:1,stores:{todos:{indexes:[{name:"byCompleted",keyPath:"completed"},{name:"byPriority",keyPath:"priority"},{name:"byCreatedAt",keyPath:"createdAt"}]},notes:{indexes:[{name:"byColor",keyPath:"color"},{name:"byUpdatedAt",keyPath:"updatedAt"}]}},crossTabSync:!0});let U="todos";const R=[];let L=null,$=null,_=null,W=null,M=null;function H(){return Math.random().toString(36).slice(2,11)}function a(r,t){const e=document.createElement(r);return t?.className&&(e.className=t.className),t?.textContent&&(e.textContent=t.textContent),t?.id&&(e.id=t.id),t?.type&&"type"in e&&(e.type=t.type),t?.placeholder&&"placeholder"in e&&(e.placeholder=t.placeholder),t?.value&&"value"in e&&(e.value=t.value),t?.min&&"min"in e&&(e.min=t.min),t?.max&&"max"in e&&(e.max=t.max),t?.dataset&&Object.entries(t.dataset).forEach(([n,s])=>{e.dataset[n]=s}),e}function x(r,t,e=!1){const n=a("option",{value:r,textContent:t});return n.selected=e,n}function J(r){return new Date(r).toLocaleString()}function at(r){switch(r){case"high":return"üî¥";case"medium":return"üü°";case"low":return"üü¢";default:return"‚ö™"}}function Lt(){f.onChange(r=>{R.unshift(r),R.length>100&&R.pop(),X()})}function X(){if(!M)return;const{logContent:r}=M;if(r.innerHTML="",R.length===0){const e=a("p",{className:"placeholder",textContent:"No events yet. Make some changes!"});r.appendChild(e);return}const t=a("ul",{className:"event-list"});R.slice(0,20).forEach(e=>{const n=new Date().toLocaleTimeString(),s=e.source==="remote"?"remote":"local",o=a("li",{className:s}),i=a("span",{className:"event-time",textContent:n}),c=a("span",{className:"event-source",textContent:e.source.toUpperCase()}),l=a("span",{className:"event-type",textContent:e.type}),d=a("span",{className:"event-store",textContent:e.storeName}),u=e.keys.slice(0,3).map(h=>typeof h=="string"?h:typeof h=="number"?String(h):h instanceof Date?h.toISOString():JSON.stringify(h)).join(", "),m=a("span",{className:"event-keys",textContent:`[${u}${e.keys.length>3?"...":""}]`});o.append(i,c,l,d,m),t.appendChild(o)}),r.appendChild(t)}function Dt(){const r=a("div",{className:"container"}),t=a("header"),e=a("h1",{textContent:"üóÑÔ∏è IndexedDB Showcase"}),n=a("p",{textContent:"Interactive demo of @mikesaintsg/indexeddb features"});t.append(e,n);const s=a("nav",{className:"tabs"}),o=a("main",{id:"content"}),i=a("footer"),c=a("p",{textContent:"üí° Open this page in another tab to see cross-tab sync in action!"});return i.appendChild(c),r.append(t,s,o,i),{container:r,header:t,nav:s,content:o,footer:i}}function Ot(r){const{nav:t}=r;[{id:"todos",emoji:"üìã",label:"Todos"},{id:"notes",emoji:"üìù",label:"Notes"},{id:"query",emoji:"üîç",label:"Query Builder"},{id:"events",emoji:"üì°",label:"Live Events"}].forEach(({id:n,emoji:s,label:o})=>{const i=a("button",{className:`tab ${U===n?"active":""}`,textContent:`${s} ${o}`});i.dataset.tab=n,i.addEventListener("click",()=>{U=n,ct()}),t.appendChild(i)})}function ct(){const r=document.getElementById("app");r&&(L?L.nav.querySelectorAll(".tab").forEach(e=>{const n=e;n.classList.toggle("active",n.dataset.tab===U)}):(r.innerHTML="",L=Dt(),Ot(L),r.appendChild(L.container)),It())}function It(){if(!L)return;const{content:r}=L;switch(r.innerHTML="",U){case"todos":Bt(r);break;case"notes":Rt(r);break;case"query":qt(r);break;case"events":kt(r);break}}function Bt(r){const t=a("section",{className:"card"}),e=a("h2",{textContent:"Todo List ‚Äî CRUD Operations"}),n=a("p",{className:"subtitle"});n.innerHTML="Demonstrates: <code>add()</code>, <code>set()</code>, <code>get()</code>, <code>remove()</code>, <code>all()</code>";const s=a("div",{className:"form-row"}),o=a("input",{type:"text",id:"todo-title",placeholder:"What needs to be done?"}),i=a("select",{id:"todo-priority"});i.append(x("low","üü¢ Low"),x("medium","üü° Medium",!0),x("high","üî¥ High"));const c=a("button",{id:"add-todo",className:"btn primary",textContent:"Add Todo"});s.append(o,i,c);const l=a("div",{className:"action-row"}),d=a("button",{id:"load-samples",className:"btn secondary",textContent:"Load Sample Todos"}),u=a("button",{id:"clear-completed",className:"btn warning",textContent:"Clear Completed"}),m=a("button",{id:"clear-todos",className:"btn danger",textContent:"Clear All"});l.append(d,u,m);const h=a("div",{className:"filter-row"}),p=a("button",{className:"filter-btn active",textContent:"All"});p.dataset.filter="all";const y=a("button",{className:"filter-btn",textContent:"Active"});y.dataset.filter="active";const A=a("button",{className:"filter-btn",textContent:"Completed"});A.dataset.filter="completed",h.append(p,y,A);const b=a("div",{id:"todo-list",className:"todo-list"}),B=a("div",{className:"loading",textContent:"Loading..."});b.appendChild(B);const S=a("div",{className:"stats",id:"todo-stats"});t.append(e,n,s,l,h,b,S),r.appendChild(t),$={titleInput:o,prioritySelect:i,addButton:c,loadSamplesButton:d,clearCompletedButton:u,clearAllButton:m,filterAllButton:p,filterActiveButton:y,filterCompletedButton:A,listContainer:b,stats:S},_t(),E()}function Rt(r){const t=a("section",{className:"card"}),e=a("h2",{textContent:"Sticky Notes ‚Äî Batch Operations & Transactions"}),n=a("p",{className:"subtitle"});n.innerHTML="Demonstrates: <code>set([...])</code> batching, <code>db.write()</code> transactions";const s=a("div",{className:"form-row"}),o=a("input",{type:"text",id:"note-title",placeholder:"Note title"}),i=a("input",{type:"text",id:"note-content",placeholder:"Note content"}),c=a("select",{id:"note-color"});c.append(x("#fff3cd","üü° Yellow"),x("#d1ecf1","üîµ Blue"),x("#d4edda","üü¢ Green"),x("#f8d7da","üî¥ Pink"));const l=a("button",{id:"add-note",className:"btn primary",textContent:"Add Note"});s.append(o,i,c,l);const d=a("div",{className:"action-row"}),u=a("button",{id:"load-sample-notes",className:"btn secondary",textContent:"Load Sample Notes (Batch)"}),m=a("button",{id:"clear-notes",className:"btn danger",textContent:"Clear All (Transaction)"});d.append(u,m);const h=a("div",{id:"notes-grid",className:"notes-grid"}),p=a("div",{className:"loading",textContent:"Loading..."});h.appendChild(p),t.append(e,n,s,d,h),r.appendChild(t),_={titleInput:o,contentInput:i,colorSelect:c,addButton:l,loadSamplesButton:u,clearAllButton:m,grid:h},Mt(),j()}function qt(r){const t=a("section",{className:"card"}),e=a("h2",{textContent:"Query Builder ‚Äî Advanced Queries"}),n=a("p",{className:"subtitle"});n.innerHTML="Demonstrates: <code>query()</code>, <code>where()</code>, <code>filter()</code>, <code>limit()</code>, <code>offset()</code>";const s=a("div",{className:"query-builder"}),o=a("div",{className:"query-row"}),i=a("label",{textContent:"Filter by Priority:"}),c=a("select",{id:"query-priority"});c.append(x("","All Priorities"),x("high","üî¥ High Only"),x("medium","üü° Medium Only"),x("low","üü¢ Low Only")),o.append(i,c);const l=a("div",{className:"query-row"}),d=a("label",{textContent:"Status:"}),u=a("select",{id:"query-status"});u.append(x("","All Status"),x("active","Active Only"),x("completed","Completed Only")),l.append(d,u);const m=a("div",{className:"query-row"}),h=a("label",{textContent:"Pagination:"}),p=a("input",{type:"number",id:"query-limit",value:"3",min:"1",max:"20"}),y=a("span",{textContent:"items per page"}),A=a("button",{id:"prev-page",className:"btn small",textContent:"‚Üê Prev"}),b=a("span",{id:"page-info",textContent:"Page 1"}),B=a("button",{id:"next-page",className:"btn small",textContent:"Next ‚Üí"});m.append(h,p,y,A,b,B);const S=a("button",{id:"run-query",className:"btn primary",textContent:"Run Query"});s.append(o,l,m,S);const k=a("div",{id:"query-results",className:"query-results"}),C=a("p",{className:"placeholder",textContent:'Click "Run Query" to see results'});k.appendChild(C);const T=a("div",{className:"code-section"}),lt=a("h3",{textContent:"Generated Code"}),F=a("div",{id:"query-code",className:"code-block"}),z=a("pre"),dt=a("code",{textContent:"// Query code will appear here"});z.appendChild(dt),F.appendChild(z),T.append(lt,F),t.append(e,n,s,k,T),r.appendChild(t),W={prioritySelect:c,statusSelect:u,limitInput:p,prevButton:A,nextButton:B,pageInfo:b,runButton:S,results:k,codeBlock:F},Kt()}function kt(r){const t=a("section",{className:"card"}),e=a("h2",{textContent:"Live Events ‚Äî Cross-Tab Synchronization"}),n=a("p",{className:"subtitle"});n.innerHTML="Demonstrates: <code>onChange()</code>, <code>BroadcastChannel</code> sync";const s=a("div",{className:"info-box"}),o=a("p");o.innerHTML="üì° <strong>Open this page in another browser tab</strong> and make changes. You'll see events appear here in real-time!";const i=a("p");i.innerHTML="üîµ <strong>LOCAL</strong> events are from this tab. üü† <strong>REMOTE</strong> events are from other tabs.",s.append(o,i);const c=a("div",{className:"action-row"}),l=a("button",{id:"trigger-add",className:"btn secondary",textContent:"Trigger Add Event"}),d=a("button",{id:"trigger-set",className:"btn secondary",textContent:"Trigger Set Event"}),u=a("button",{id:"trigger-remove",className:"btn secondary",textContent:"Trigger Remove Event"}),m=a("button",{id:"clear-log",className:"btn danger",textContent:"Clear Log"});c.append(l,d,u,m);const h=a("div",{id:"event-log-content",className:"event-log"}),p=a("p",{className:"placeholder",textContent:"No events yet. Make some changes!"});h.appendChild(p),t.append(e,n,s,c,h),r.appendChild(t),M={triggerAddButton:l,triggerSetButton:d,triggerRemoveButton:u,clearLogButton:m,logContent:h},Ut(),X()}function jt(r){const t=a("div",{className:`todo-item ${r.completed?"completed":""}`,dataset:{id:r.id}}),e=a("input",{type:"checkbox"});e.className="todo-toggle",e.checked=r.completed;const n=a("span",{className:"priority",textContent:at(r.priority)}),s=a("span",{className:"todo-title",textContent:r.title}),o=a("span",{className:"todo-date",textContent:J(r.createdAt)}),i=a("button",{className:"delete-btn",textContent:"√ó"});return i.title="Delete",t.append(e,n,s,o,i),t}async function E(r="all"){if(!$)return;const{listContainer:t,stats:e}=$;try{const n=await f.store("todos").all();let s;r==="all"?s=n:r==="completed"?s=n.filter(u=>u.completed):s=n.filter(u=>!u.completed);const o=[...s].sort((u,m)=>m.createdAt-u.createdAt);if(t.innerHTML="",o.length===0){const u=a("p",{className:"empty",textContent:r==="all"?"No todos yet. Add one above or load samples!":`No ${r} todos.`});t.appendChild(u)}else o.forEach(u=>{t.appendChild(jt(u))});const i=n.filter(u=>u.completed).length;e.innerHTML="";const c=a("span");c.innerHTML="üìä Total: <strong>"+n.length+"</strong>";const l=a("span");l.innerHTML="‚úÖ Completed: <strong>"+i+"</strong>";const d=a("span");d.innerHTML="‚è≥ Active: <strong>"+(n.length-i)+"</strong>",e.append(c,l,d)}catch(n){t.innerHTML="";const s=a("p",{className:"error",textContent:`Error loading todos: ${String(n)}`});t.appendChild(s)}}function $t(r){const t=a("div",{className:"note-card",dataset:{id:r.id}});t.style.backgroundColor=r.color;const e=a("h3",{textContent:r.title}),n=a("p",{textContent:r.content}),s=a("div",{className:"note-footer"}),o=a("span",{textContent:J(r.updatedAt)}),i=a("button",{className:"delete-note-btn",textContent:"√ó"});return i.title="Delete",s.append(o,i),t.append(e,n,s),t}async function j(){if(!_)return;const{grid:r}=_;try{const e=[...await f.store("notes").all()].sort((n,s)=>s.updatedAt-n.updatedAt);if(r.innerHTML="",e.length===0){const n=a("p",{className:"empty",textContent:"No notes yet. Add one above or load samples!"});r.appendChild(n)}else e.forEach(n=>{r.appendChild($t(n))})}catch(t){r.innerHTML="";const e=a("p",{className:"error",textContent:`Error loading notes: ${String(t)}`});r.appendChild(e)}}function _t(){if(!$)return;const{titleInput:r,prioritySelect:t,addButton:e,loadSamplesButton:n,clearCompletedButton:s,clearAllButton:o,filterAllButton:i,filterActiveButton:c,filterCompletedButton:l,listContainer:d}=$,u=async()=>{const h=r.value.trim();h&&(await f.store("todos").add({id:H(),title:h,completed:!1,priority:t.value,createdAt:Date.now()}),r.value="",E())};e.addEventListener("click",()=>{u()}),r.addEventListener("keypress",h=>{h.key==="Enter"&&u()}),n.addEventListener("click",()=>{(async()=>(await f.store("todos").set([...Tt]),E()))()}),s.addEventListener("click",()=>{(async()=>{const p=(await f.store("todos").all()).filter(y=>y.completed).map(y=>y.id);p.length>0&&await f.store("todos").remove(p),E()})()}),o.addEventListener("click",()=>{(async()=>(await f.store("todos").clear(),E()))()});const m=h=>{i.classList.remove("active"),c.classList.remove("active"),l.classList.remove("active"),h.classList.add("active")};i.addEventListener("click",()=>{m(i),E("all")}),c.addEventListener("click",()=>{m(c),E("active")}),l.addEventListener("click",()=>{m(l),E("completed")}),d.addEventListener("click",h=>{const p=h.target,y=p.closest(".todo-item");if(!y)return;const A=y.dataset.id;A&&(async()=>{if(p.classList.contains("todo-toggle")){const b=await f.store("todos").get(A);b&&(await f.store("todos").set({...b,completed:!b.completed}),E())}else p.classList.contains("delete-btn")&&(await f.store("todos").remove(A),E())})()})}function Mt(){if(!_)return;const{titleInput:r,contentInput:t,colorSelect:e,addButton:n,loadSamplesButton:s,clearAllButton:o,grid:i}=_,c=async()=>{const l=r.value.trim()||"Untitled",d=t.value.trim()||"";await f.store("notes").add({id:H(),title:l,content:d,color:e.value,updatedAt:Date.now()}),r.value="",t.value="",j()};n.addEventListener("click",()=>{c()}),s.addEventListener("click",()=>{(async()=>(await f.store("notes").set([...Pt]),j()))()}),o.addEventListener("click",()=>{(async()=>(await f.write("notes",async l=>{await l.store("notes").clear()}),j()))()}),i.addEventListener("click",l=>{const d=l.target;if(!d.classList.contains("delete-note-btn"))return;const u=d.closest(".note-card");if(!u)return;const m=u.dataset.id;m&&(async()=>(await f.store("notes").remove(m),j()))()})}let P=0,G=0;function Vt(r){const t=a("table"),e=a("thead"),n=a("tr");n.append(a("th",{textContent:"Title"}),a("th",{textContent:"Priority"}),a("th",{textContent:"Status"}),a("th",{textContent:"Created"})),e.appendChild(n);const s=a("tbody");return r.forEach(o=>{const i=a("tr",{className:o.completed?"completed":""}),c=a("td",{textContent:o.title}),l=a("td",{textContent:`${at(o.priority)} ${o.priority}`}),d=a("td",{textContent:o.completed?"‚úÖ Done":"‚è≥ Active"}),u=a("td",{textContent:J(o.createdAt)});i.append(c,l,d,u),s.appendChild(i)}),t.append(e,s),t}function Kt(){if(!W)return;const{prioritySelect:r,statusSelect:t,limitInput:e,prevButton:n,nextButton:s,pageInfo:o,runButton:i,results:c,codeBlock:l}=W,d=async()=>{const u=r.value,m=t.value,h=parseInt(e.value,10)||3;let p=f.store("todos").query();const y=["db.store('todos').query()"];if(u&&(p=p.where("byPriority").equals(u),y.push(`  .where('byPriority').equals('${u}')`)),m){const C=m==="completed";p=p.filter(T=>T.completed===C),y.push(`  .filter(t => t.completed === ${String(C)})`)}if(G=(await p.toArray()).length,p=f.store("todos").query(),u&&(p=p.where("byPriority").equals(u)),m){const C=m==="completed";p=p.filter(T=>T.completed===C)}p=p.limit(h).offset(P*h),y.push(`  .limit(${h}).offset(${P*h})`),y.push("  .toArray()");const b=await p.toArray();if(c.innerHTML="",b.length===0&&P===0){const C=a("p",{className:"empty",textContent:"No results found. Try loading sample todos first!"});c.appendChild(C)}else if(b.length===0){const C=a("p",{className:"empty",textContent:"No more results on this page."});c.appendChild(C)}else{const C=Vt(b),T=a("p",{className:"result-count",textContent:`Showing ${b.length} of ${G} total results`});c.append(C,T)}const B=Math.ceil(G/h)||1;o.textContent=`Page ${P+1} of ${B}`;const S=a("pre"),k=a("code",{textContent:y.join(`
`)});S.appendChild(k),l.innerHTML="",l.appendChild(S)};i.addEventListener("click",()=>{P=0,d()}),n.addEventListener("click",()=>{P>0&&(P--,d())}),s.addEventListener("click",()=>{P++,d()}),d()}function Ut(){if(!M)return;const{triggerAddButton:r,triggerSetButton:t,triggerRemoveButton:e,clearLogButton:n}=M;r.addEventListener("click",()=>{(async()=>await f.store("todos").add({id:H(),title:`Event Test ${new Date().toLocaleTimeString()}`,completed:!1,priority:"low",createdAt:Date.now()}))()}),t.addEventListener("click",()=>{(async()=>{const s=await f.store("todos").all();if(s.length>0){const o=s[0];o&&await f.store("todos").set({...o,title:`Updated ${new Date().toLocaleTimeString()}`})}else await f.store("todos").set({id:H(),title:`Set Event ${new Date().toLocaleTimeString()}`,completed:!1,priority:"medium",createdAt:Date.now()})})()}),e.addEventListener("click",()=>{(async()=>{const s=await f.store("todos").all();s.length>0&&s[0]&&await f.store("todos").remove(s[0].id)})()}),n.addEventListener("click",()=>{R.length=0,X()})}Lt();ct();</script>
  <style rel="stylesheet" crossorigin>*{box-sizing:border-box;margin:0;padding:0}:root{--primary: #4f46e5;--primary-hover: #4338ca;--danger: #dc2626;--danger-hover: #b91c1c;--warning: #f59e0b;--warning-hover: #d97706;--secondary: #6b7280;--secondary-hover: #4b5563;--success: #10b981;--bg: #f3f4f6;--card-bg: #ffffff;--text: #1f2937;--text-muted: #6b7280;--border: #e5e7eb;--radius: 8px;--shadow: 0 1px 3px rgba(0, 0, 0, .1);--shadow-lg: 0 4px 6px -1px rgba(0, 0, 0, .1)}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,sans-serif;background:var(--bg);color:var(--text);line-height:1.5;min-height:100vh}.container{max-width:900px;margin:0 auto;padding:20px}header{text-align:center;margin-bottom:24px}header h1{font-size:2rem;margin-bottom:8px;color:var(--primary)}header p{color:var(--text-muted)}footer{text-align:center;margin-top:32px;padding:16px;color:var(--text-muted);font-size:.875rem;background:#e0e7ff;border-radius:var(--radius)}.tabs{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap}.tab{padding:10px 20px;border:none;background:var(--card-bg);border-radius:var(--radius);cursor:pointer;font-size:.95rem;font-weight:500;transition:all .2s;box-shadow:var(--shadow)}.tab:hover{background:var(--border)}.tab.active{background:var(--primary);color:#fff}.card{background:var(--card-bg);border-radius:var(--radius);padding:24px;box-shadow:var(--shadow-lg)}.card h2{margin-bottom:4px;font-size:1.5rem}.card .subtitle{color:var(--text-muted);margin-bottom:20px;font-size:.875rem}.card code{background:#f1f5f9;padding:2px 6px;border-radius:4px;font-size:.85rem;color:var(--primary)}.form-row,.action-row{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap}input[type=text],input[type=number],select{padding:10px 14px;border:1px solid var(--border);border-radius:var(--radius);font-size:.95rem;background:#fff;flex:1;min-width:120px}input[type=text]:focus,input[type=number]:focus,select:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px #4f46e51a}input[type=number]{width:80px;flex:none}.btn{padding:10px 18px;border:none;border-radius:var(--radius);font-size:.95rem;font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap}.btn.small{padding:6px 12px;font-size:.85rem}.btn.primary{background:var(--primary);color:#fff}.btn.primary:hover{background:var(--primary-hover)}.btn.secondary{background:var(--secondary);color:#fff}.btn.secondary:hover{background:var(--secondary-hover)}.btn.warning{background:var(--warning);color:#fff}.btn.warning:hover{background:var(--warning-hover)}.btn.danger{background:var(--danger);color:#fff}.btn.danger:hover{background:var(--danger-hover)}.filter-row{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap;align-items:center}.filter-btn{padding:6px 14px;border:1px solid var(--border);background:#fff;border-radius:20px;cursor:pointer;font-size:.875rem;transition:all .2s}.filter-btn:hover{background:var(--border)}.filter-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}.todo-list{max-height:400px;overflow-y:auto;border:1px solid var(--border);border-radius:var(--radius)}.todo-item{display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--border);transition:background .2s}.todo-item:last-child{border-bottom:none}.todo-item:hover{background:#f9fafb}.todo-item.completed .todo-title{text-decoration:line-through;color:var(--text-muted)}.todo-toggle{width:20px;height:20px;cursor:pointer;flex-shrink:0}.priority{font-size:1rem;flex-shrink:0}.todo-title{flex:1;font-size:.95rem}.todo-date{font-size:.75rem;color:var(--text-muted);flex-shrink:0}.delete-btn{width:28px;height:28px;border:none;background:transparent;color:var(--text-muted);font-size:1.2rem;cursor:pointer;border-radius:50%;transition:all .2s;flex-shrink:0}.delete-btn:hover{background:var(--danger);color:#fff}.stats{display:flex;gap:24px;padding-top:16px;border-top:1px solid var(--border);margin-top:16px;font-size:.875rem;color:var(--text-muted)}.stats strong{color:var(--text)}.notes-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px;margin-top:16px}.note-card{padding:16px;border-radius:var(--radius);box-shadow:var(--shadow);transition:transform .2s,box-shadow .2s}.note-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg)}.note-card h3{font-size:1rem;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.note-card p{font-size:.875rem;color:#374151;margin-bottom:12px;max-height:60px;overflow:hidden}.note-footer{display:flex;justify-content:space-between;align-items:center;font-size:.75rem;color:var(--text-muted)}.delete-note-btn{width:24px;height:24px;border:none;background:#0000001a;border-radius:50%;cursor:pointer;font-size:1rem;line-height:1}.delete-note-btn:hover{background:var(--danger);color:#fff}.query-builder{background:#f8fafc;padding:20px;border-radius:var(--radius);margin-bottom:20px}.query-row{display:flex;align-items:center;gap:12px;margin-bottom:12px;flex-wrap:wrap}.query-row label{width:140px;font-weight:500;font-size:.875rem;flex-shrink:0}.query-row select{flex:none;width:180px}.query-results{min-height:100px;margin-bottom:20px}.query-results table{width:100%;border-collapse:collapse}.query-results th,.query-results td{padding:10px 12px;text-align:left;border-bottom:1px solid var(--border)}.query-results th{background:#f8fafc;font-weight:600;font-size:.875rem}.query-results td{font-size:.875rem}.query-results tr.completed td{color:var(--text-muted)}.result-count{margin-top:12px;font-size:.875rem;color:var(--text-muted)}.code-section h3{font-size:.95rem;margin-bottom:8px;color:var(--text-muted)}.code-block{background:#1e293b;color:#e2e8f0;padding:16px;border-radius:var(--radius);overflow-x:auto}.code-block pre{margin:0;font-family:Fira Code,Monaco,Consolas,monospace;font-size:.85rem;line-height:1.6}.info-box{background:#dbeafe;border:1px solid #93c5fd;padding:16px;border-radius:var(--radius);margin-bottom:20px}.info-box p{color:#1e40af;margin:0 0 8px}.info-box p:last-child{margin-bottom:0}.event-log{background:#1e293b;color:#e2e8f0;padding:16px;border-radius:var(--radius);max-height:400px;overflow-y:auto;font-family:Fira Code,Monaco,Consolas,monospace;font-size:.85rem}.event-list{list-style:none}.event-list li{padding:8px 12px;border-bottom:1px solid #334155;display:flex;gap:12px;align-items:center}.event-list li:last-child{border-bottom:none}.event-list li.local{border-left:3px solid #3b82f6}.event-list li.remote{border-left:3px solid #f59e0b;background:#f59e0b1a}.event-time{color:#94a3b8;font-size:.75rem}.event-source{font-weight:600;font-size:.75rem;padding:2px 6px;border-radius:4px}.event-list li.local .event-source{background:#3b82f6;color:#fff}.event-list li.remote .event-source{background:#f59e0b;color:#fff}.event-type{color:#22c55e}.event-store{color:#a78bfa}.event-keys{color:#94a3b8;font-size:.75rem}.loading{text-align:center;padding:40px;color:var(--text-muted)}.empty,.placeholder{text-align:center;padding:40px;color:var(--text-muted);font-style:italic}.error{color:var(--danger);text-align:center;padding:20px}@media(max-width:600px){.container{padding:12px}header h1{font-size:1.5rem}.tabs{gap:4px}.tab{padding:8px 12px;font-size:.85rem}.form-row{flex-direction:column}.form-row input,.form-row select{width:100%}.action-row{flex-direction:column}.action-row .btn{width:100%}.query-row{flex-direction:column;align-items:stretch}.query-row label,.query-row select{width:100%}.stats{flex-direction:column;gap:8px}}</style>
</head>
<body>
<div id="app"></div>
</body>
</html>
